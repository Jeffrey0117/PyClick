# PyClick - 智能自動點擊器

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![Platform](https://img.shields.io/badge/Platform-Windows-lightgrey.svg)

螢幕圖像識別 + 自動點擊工具。截圖選取目標，程式自動在螢幕上找到並點擊。

## 功能特色

- **模板匹配** - 截圖框選目標，自動記憶圖案
- **藍色偵測** - HSV 色彩偵測，快速定位藍色區域
- **自動點擊** - 持續掃描螢幕，找到就點
- **熱鍵觸發** - 按 F6 手動觸發找圖點擊
- **不搶焦點** - 使用底層 API，點擊時不會切換視窗
- **低耗能** - 畫面沒變就跳過掃描，可調整間隔
- **系統托盤** - 可縮小到右下角背景運行

## 安裝

```bash
pip install -r requirements.txt
```

### 依賴套件

- `mss` - 螢幕截圖
- `opencv-python` - 圖像處理、模板匹配
- `numpy` - 數值計算
- `pyautogui` - 滑鼠控制
- `Pillow` - 圖像處理
- `keyboard` - 熱鍵監聽
- `pystray` - 系統托盤

## 使用方式

```bash
python tray_clicker.py
```

### 操作流程

1. **截圖** - 擷取當前螢幕
2. **偵測藍色**（可選）- 標記出藍色區域輔助定位
3. **拖曳框選** - 在預覽圖上框選要點擊的目標
4. **儲存選取** - 記住這個模板
5. **選擇模式**：
   - `關閉` - 停止所有動作
   - `熱鍵 (F6)` - 按 F6 時找圖點擊
   - `自動點擊` - 持續掃描，找到就點

### 掃描間隔

| 設定 | 說明 |
|------|------|
| 0.3 秒 | 快速反應 |
| 0.5 秒 | 標準（預設）|
| 1.0 秒 | 省電 |
| 2.0 秒 | 超省電 |

## 省電策略

- **畫面 Hash 比對** - 螢幕沒變化就跳過模板匹配
- **點擊冷卻** - 點完後暫停 1 秒避免連點
- **可調間隔** - 依需求調整掃描頻率

## 檔案說明

| 檔案 | 說明 |
|------|------|
| `tray_clicker.py` | 主程式（完整面板 + 托盤）|
| `smart_clicker.py` | 舊版（純視窗版）|
| `blue_click_gui.py` | 藍色偵測版 |
| `blue_mini.py` | 極簡三按鈕版 |

## 托盤圖示

| 圖示 | 狀態 |
|------|------|
| 🔵 藍底 `?` | 尚未設定模板 |
| 🔵 藍底 `O` | 已設定，模式關閉 |
| 🟠 橘底 `H` | 熱鍵模式 |
| 🟢 綠底 `A` | 自動點擊模式 |

## 注意事項

- 需要 **Windows** 系統（使用 Windows API）
- 點擊使用底層 `mouse_event`，不會搶奪視窗焦點
- `pyautogui.FAILSAFE = True`：滑鼠移到左上角可中斷

## License

MIT
